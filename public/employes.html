<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion des Employés</title>
     <!-- Bootstrap CSS -->
     <link rel="stylesheet" href="assets/vendor/bootstrap/css/bootstrap.min.css">
     <link href="assets/vendor/fonts/circular-std/style.css" rel="stylesheet">
     <link rel="stylesheet" href="assets/libs/css/style.css">
     <link rel="stylesheet" href="assets/vendor/fonts/fontawesome/css/fontawesome-all.css">
 <style>
    body {
    font-family: Arial, sans-serif;
}

form {
    margin-bottom: 20px;
}

form label {
    display: block;
    margin-top: 10px;
}

form input {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
}

form button {
    margin-top: 20px;
    padding: 10px 15px;
    background-color: #4CAF50;
    color: white;
    border: none;
    cursor: pointer;
}

form button:hover {
    background-color: #45a049;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

table, th, td {
    border: 1px solid black;
}

th, td {
    padding: 8px;
    text-align: left;
}

 </style>
</head>
<body class="container">
    <div class="dashboard-main-wrapper">
        <!-- ============================================================== -->
        <!-- navbar -->
        <!-- ============================================================== -->
        <div class="dashboard-header">
            <nav class="navbar navbar-expand-lg bg-white fixed-top">
                <a class="navbar-brand" href="home.html">DUEN-HOTEL</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse " id="navbarSupportedContent">
                    <ul class="navbar-nav ml-auto navbar-right-top">
                       
                        <li class="nav-item dropdown notification">
                            <a class="nav-link nav-icons" href="#" id="navbarDropdownMenuLink1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fas fa-fw fa-bell"></i> <span class="indicator"></span></a>
                            <ul class="dropdown-menu dropdown-menu-right notification-dropdown">
                               
                                <li>
                                    <div class="list-footer"> <a href="#">View all notifications</a></div>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item dropdown connection">
                            <a class="nav-link" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="fas fa-fw fa-plus"></i> </a>
                            <ul class="dropdown-menu dropdown-menu-right connection-dropdown">
                               
                                <li class="connection-list">
                                    <div class="conntection-footer"><a href="restoandbarinvoice.html">Drink-Food-Invoice</a></div>
                                        
                                </li>
                               
                                <li class="connection-list">
                                    <div class="conntection-footer"><a href="roomandpoolinvoice.html">Room-Pool-Invoice</a></div>
                                        
                                </li>
                               
                                   
                                        <li class="connection-list">
                                            <div class="conntection-footer"><a href="updatebarandresto.html">UpdateDrink-Food</a></div>
                                                
                                        </li>
                                        <li class="connection-list">
                                            <div class="conntection-footer"><a href="updateroomandpool.html">UpdateRoom-Pool</a></div>
                                                
                                        </li>
                                <li class="connection-list">
                                    <div class="conntection-footer"><a href="newexpences.html">Expenses</a></div>
                                        
                                </li>
                               
                            </ul>
                        </li>
                        <li class="nav-item dropdown nav-user">
                            <a class="nav-link nav-user-img" href="#" id="navbarDropdownMenuLink2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><img src="assets/images/iconuser (2).png" alt="" class="user-avatar-md rounded-circle"></a>
                            <div class="dropdown-menu dropdown-menu-right nav-user-dropdown" aria-labelledby="navbarDropdownMenuLink2">
                                <div class="nav-user-info">
                                    <h5 class="mb-0 text-white nav-user-name" id="username"></h5>
                                    <span class="status"></span><span class="ml-2" id="email"></span>
                                </div>
                                <a class="dropdown-item" href="#"><i class="fas fa-user mr-2"></i>Account</a>
                                <a class="dropdown-item" href="#"><i class="fas fa-cog mr-2"></i>Setting</a>
                                <a id="logout" class="dropdown-item" href="#"><i class="fas fa-power-off mr-2"></i>Logout</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
        <!-- ============================================================== -->
        <!-- end navbar -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->
        <!-- left sidebar -->
        <!-- ============================================================== -->
       
        <br><br>
    <div class="card">
    <h1>Gestion des Employés</h1>
    
    <form id="employeeForm" style="margin-right: 20px; margin-left: 20px;" >
        <label for="nomcomplet"  class="form-control form-control-lg" >Nom Complet:</label>
        <input  class="form-control form-control-lg"  type="text" id="nomcomplet" name="nomcomplet" required><br>
        
        <label for="id"  class="form-control form-control-lg" >ID:</label>
        <input  class="form-control form-control-lg"  type="text" id="id" name="id" required><br>
        
        <label  class="form-control form-control-lg"  for="adresse">Adresse:</label>
        <input  class="form-control form-control-lg"  type="text" id="adresse" name="adresse" required><br>
        
        <label  class="form-control form-control-lg"  for="phone">Téléphone:</label>
        <input  class="form-control form-control-lg"  type="text" id="phone" name="phone" required><br>
        
        <label  class="form-control form-control-lg"  for="fonction">Fonction:</label>
        <input  class="form-control form-control-lg"  type="text" id="fonction" name="fonction" required><br>
        
        <label  class="form-control form-control-lg"  for="salaire">Salaire:</label>
        <input  class="form-control form-control-lg"  type="text" id="salaire" name="salaire" required><br>
        
        <label  class="form-control form-control-lg"  for="contact">Personne de Contact:</label>
        <input  class="form-control form-control-lg"  type="text" id="contact" name="contact" required><br>
        
        <label  class="form-control form-control-lg"  for="phone_contact">Téléphone de Contact:</label>
        <input  class="form-control form-control-lg"  type="text" id="phone_contact" name="phone_contact" required><br>
        
        <label  class="form-control form-control-lg"  for="alergie">Allergie:</label>
        <input  class="form-control form-control-lg"  type="text" id="alergie" name="alergie"><br>
        
        <label  class="form-control form-control-lg"  for="maladie">Maladie:</label>
        <input  class="form-control form-control-lg"  type="text" id="maladie" name="maladie"><br>
        
        <button type="submit">Enregistrer</button>
    </form>
    
    
    <h2>Liste des Employés</h2>
    <table id="employeeTable">
        <thead>
            <tr>
                <th>Nom Complet</th>
                <th>ID</th>
                <th>Adresse</th>
                <th>Téléphone</th>
                <th>Fonction</th>
                <th>Salaire</th>
                <th>Personne de Contact</th>
                <th>Téléphone de Contact</th>
                <th>Allergie</th>
                <th>Maladie</th>
                <th>Actions</th> <!-- New Actions Column -->
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    
</div>
<script src="https://konbitmarket.netlify.app/js/js/firebase-app.js"></script>
<script src="https://konbitmarket.netlify.app/js/js/auth.js"></script>
<script src="https://konbitmarket.netlify.app/js/js/firebase-firestore.js"></script>
<script src="firebase-config.js"></script>

<script>


// Référence au formulaire et au tableau
const employeeForm = document.getElementById('employeeForm');
const employeeTableBody = document.querySelector('#employeeTable tbody');
let editingEmployeeId = null;

// Fonction pour ajouter ou mettre à jour un employé dans la base de données et le tableau
employeeForm.addEventListener('submit', (e) => {
    e.preventDefault();

    const employee = {
        nomcomplet: employeeForm.nomcomplet.value,
        id: employeeForm.id.value,
        adresse: employeeForm.adresse.value,
        phone: employeeForm.phone.value,
        fonction: employeeForm.fonction.value,
        salaire: employeeForm.salaire.value,
        contact: employeeForm.contact.value,
        phone_contact: employeeForm.phone_contact.value,
        alergie: employeeForm.alergie.value,
        maladie: employeeForm.maladie.value,
    };

    if (editingEmployeeId) {
        db.collection('employes').doc(editingEmployeeId).update(employee).then(() => {
            console.log('Employé mis à jour !');
            employeeForm.reset();
            editingEmployeeId = null;
            loadEmployees();
        }).catch((error) => {
            console.error('Erreur lors de la mise à jour de l\'employé : ', error);
        });
    } else {
        db.collection('employes').add(employee).then(() => {
            console.log('Employé ajouté !');
            employeeForm.reset();
            loadEmployees();
        }).catch((error) => {
            console.error('Erreur lors de l\'ajout de l\'employé : ', error);
        });
    }
});

// Fonction pour charger et afficher les employés
function loadEmployees() {
    db.collection('employes').get().then((querySnapshot) => {
        employeeTableBody.innerHTML = '';
        querySnapshot.forEach((doc) => {
            const employee = doc.data();
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${employee.nomcomplet}</td>
                <td>${employee.id}</td>
                <td>${employee.adresse}</td>
                <td>${employee.phone}</td>
                <td>${employee.fonction}</td>
                <td>${employee.salaire}</td>
                <td>${employee.contact}</td>
                <td>${employee.phone_contact}</td>
                <td>${employee.alergie}</td>
                <td>${employee.maladie}</td>
                <td class="action-buttons">
                    <button class="edit" onclick="editEmployee('${doc.id}')">Éditer</button>
                    <button class="delete" onclick="deleteEmployee('${doc.id}')">Supprimer</button>
                </td>
            `;
            employeeTableBody.appendChild(row);
        });
    });
}

// Fonction pour éditer un employé
function editEmployee(employeeId) {
    db.collection('employes').doc(employeeId).get().then((doc) => {
        const employee = doc.data();
        employeeForm.nomcomplet.value = employee.nomcomplet;
        employeeForm.id.value = employee.id;
        employeeForm.adresse.value = employee.adresse;
        employeeForm.phone.value = employee.phone;
        employeeForm.fonction.value = employee.fonction;
        employeeForm.salaire.value = employee.salaire;
        employeeForm.contact.value = employee.contact;
        employeeForm.phone_contact.value = employee.phone_contact;
        employeeForm.alergie.value = employee.alergie;
        employeeForm.maladie.value = employee.maladie;
        editingEmployeeId = employeeId;
    }).catch((error) => {
        console.error('Erreur lors de l\'édition de l\'employé : ', error);
    });
}

// Fonction pour supprimer un employé
function deleteEmployee(employeeId) {
    db.collection('employes').doc(employeeId).delete().then(() => {
        console.log('Employé supprimé !');
        loadEmployees();
    }).catch((error) => {
        console.error('Erreur lors de la suppression de l\'employé : ', error);
    });
}

// Charger les employés au chargement de la page
window.onload = loadEmployees;

</script>


    <!-- jquery 3.3.1 -->
    <script src="assets/vendor/jquery/jquery-3.3.1.min.js"></script>
    <!-- bootstap bundle js -->
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.js"></script>
    <!-- slimscroll js -->
    <script src="assets/vendor/slimscroll/jquery.slimscroll.js"></script>
    <!-- main js -->
    <script src="assets/libs/js/main-js.js"></script>
    <!-- chart chartist js -->
    <script src="assets/vendor/charts/chartist-bundle/chartist.min.js"></script>
    <!-- sparkline js -->
    <script src="assets/vendor/charts/sparkline/jquery.sparkline.js"></script>
    <!-- morris js -->
    <script src="assets/vendor/charts/morris-bundle/raphael.min.js"></script>
    <script src="assets/vendor/charts/morris-bundle/morris.js"></script>
    <!-- chart c3 js -->
    <script src="assets/vendor/charts/c3charts/c3.min.js"></script>
    <script src="assets/vendor/charts/c3charts/d3-5.4.0.min.js"></script>
    <script src="assets/vendor/charts/c3charts/C3chartjs.js"></script>
    <script src="assets/libs/js/dashboard-ecommerce.js"></script>
</body>
</html>
